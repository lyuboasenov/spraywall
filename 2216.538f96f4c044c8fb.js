"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2216],{2216:(k,f,a)=>{a.r(f),a.d(f,{AddRouteSchemaPageModule:()=>F});var H=a(177),R=a(4341),d=a(9364),h=a(8986),m=a(467),s=a(3875),e=a(4438),T=a(3245),A=a(4943),S=a(2542);const P=["canvas"],M=["zoom"],w=[{path:"",component:(()=>{var l;class r{constructor(t,o,i){this.routeService=t,this.wallTemplateService=o,this.loadingCtrl=i,this.template=null,this.holds=[],this._selectedHold=null}ngOnInit(){var t=this;return(0,m.A)(function*(){yield t.showLoading(),t.wallTemplateService.drawTemplateBackdrop(t.canvas.nativeElement),t.template=yield t.wallTemplateService.getTemplate(),t.routeService.holdBuffer=[],t.holds=t.routeService.holdBuffer,t.loading.dismiss()})()}showLoading(){var t=this;return(0,m.A)(function*(){t.loading=yield t.loadingCtrl.create({message:"Loading routes..."}),t.loading.present()})()}templateClick(t){var o=this;return(0,m.A)(function*(){const i=Math.min(o.wallTemplateService.width/t.target.offsetWidth,o.wallTemplateService.height/t.target.offsetHeight),v=(t.layerX+(t.target.offsetWidth-t.target.parentElement.clientWidth)/2)*i,g=(t.layerY+(t.target.offsetHeight-t.target.parentElement.clientHeight)/2)*i,p=yield o.wallTemplateService.findHold(v,g);if(p){let n;for(const u of o.holds)if(u.TemplateHold===p){n=u;break}if(n)if(n.Type==s.S.FootHold){n.Type=s.S.Hold;let u=o.holds.indexOf(n);o.holds.splice(u,1),o._selectedHold=null}else n.Type==s.S.StartingHold?n.Type=s.S.Hold:n.Type==s.S.Hold?n.Type=s.S.FinishingHold:n.Type==s.S.FinishingHold&&(n.Type=s.S.FootHold),o._selectedHold=n;else{const u={Type:0==o.holds.length?s.S.StartingHold:s.S.Hold,TemplateHold:p};o.holds.push(u),o._selectedHold=u}}const y=o.canvas.nativeElement;yield o.wallTemplateService.drawTemplateBackdrop(y),yield o.wallTemplateService.markHolds(o.holds,o._selectedHold,y)})()}}return(l=r).\u0275fac=function(t){return new(t||l)(e.rXU(T.v),e.rXU(A.s),e.rXU(d.Xi))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-add-route-schema"]],viewQuery:function(t,o){if(1&t&&(e.GBs(P,7),e.GBs(M,7)),2&t){let i;e.mGM(i=e.lsd())&&(o.canvas=i.first),e.mGM(i=e.lsd())&&(o.zoom=i.first)}},outputs:{holds:"holds"},decls:21,vars:4,consts:[["zoom",""],["canvas",""],[3,"translucent"],["slot","primary"],["fill","solid","routerLink","/routes"],["name","close-circle-outline"],["fill","solid","routerLink","details",3,"disabled"],["name","checkmark-outline"],[3,"fullscreen"],["collapse","condense"],["size","large"],["id","container"],["id","zoom",3,"limit-zoom"],["width","1500","height","700",3,"click"]],template:function(t,o){if(1&t){const i=e.RV6();e.j41(0,"ion-header",2)(1,"ion-toolbar")(2,"ion-buttons",3)(3,"ion-button",4),e.nrm(4,"ion-icon",5),e.k0s()(),e.j41(5,"ion-buttons",3)(6,"ion-button",6),e.nrm(7,"ion-icon",7),e.k0s()(),e.j41(8,"ion-title"),e.EFF(9,"New route"),e.k0s()()(),e.j41(10,"ion-content",8)(11,"ion-header",9)(12,"ion-toolbar")(13,"ion-title",10),e.EFF(14,"add-route-schema"),e.k0s()()(),e.j41(15,"div",11)(16,"pinch-zoom",12,0)(18,"canvas",13,1),e.bIt("click",function(g){return e.eBV(i),e.Njj(o.templateClick(g))}),e.EFF(20," Not supported on this browser "),e.k0s()()()()}2&t&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("disabled",!(o.holds.length>1)),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(6),e.Y8G("limit-zoom",20))},dependencies:[d.Jm,d.QW,d.W9,d.eU,d.iq,d.BC,d.ai,d.N7,h.Wk,S.Hg],styles:["#container[_ngcontent-%COMP%], #container[_ngcontent-%COMP%]   #zoom[_ngcontent-%COMP%]{width:100%;height:100%}"]}),r})()}];let C=(()=>{var l;class r{}return(l=r).\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[h.iI.forChild(w),h.iI]}),r})(),F=(()=>{var l;class r{}return(l=r).\u0275fac=function(t){return new(t||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[H.MD,R.YN,d.bv,C,S.Ud]}),r})()}}]);